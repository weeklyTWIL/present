(this.webpackJsonpclosterwebapplication=this.webpackJsonpclosterwebapplication||[]).push([[0],{105:function(e,t,c){"use strict";c.r(t);var n=c(0),s=c.n(n),r=c(39),o=c.n(r),a=(c(79),c(63)),l=c.n(a),i=c(44),j=c(29),u=c(4),d=c(34),b=c(10),h=c(40),O=c.n(h),x=c(46),f=c(2);function m(e){return Object(n.useEffect)((function(){var t=document.getElementById("stream");console.log(t,e.stream),t.srcObject=e.stream}),[]),Object(f.jsx)("div",{className:"h-full w-full",children:Object(f.jsx)("video",{id:"stream",autoPlay:!0,className:"w-full h-full"})})}function p(e){return Object(f.jsx)("div",{className:"h-full w-full flex items-center justify-center",children:Object(f.jsx)("h1",{className:"text-7xl",children:e.code})})}function g(e){var t=Object(n.useState)({name:"",secret:""}),c=Object(b.a)(t,2),s=c[0],r=c[1];return Object(f.jsxs)("div",{className:"flex flex-col p-6 shadow space-y-4 bg-gray-300 rounded",children:[Object(f.jsx)("h1",{className:"text-center",children:"register a new host"}),Object(f.jsxs)("div",{className:"space-y-2",children:[Object(f.jsx)("label",{className:"block",children:Object(f.jsx)("span",{children:"name:"})}),Object(f.jsx)("input",{className:"p-2 rounded ",autoFocus:!0,value:s.name,onChange:function(e){return r(Object(d.a)(Object(d.a)({},s),{},{name:e.target.value}))}})]}),Object(f.jsxs)("div",{className:"space-y-2",children:[Object(f.jsx)("label",{className:"block",children:Object(f.jsx)("span",{children:"secret:"})}),Object(f.jsx)("input",{className:"p-2 rounded ",autoFocus:!0,value:s.secret,onChange:function(e){return r(Object(d.a)(Object(d.a)({},s),{},{secret:e.target.value}))}})]}),e.error&&Object(f.jsx)("p",{className:"py-2 px-4 bg-red-500 rounded",children:e.error}),Object(f.jsx)("button",{className:"bg-gray-500 rounded p-2",onClick:function(){return e.onSubmit(s)},children:"register"})]})}var v=function(){var e=Object(n.useState)(null),t=Object(b.a)(e,2),c=t[0],s=t[1],r=Object(n.useState)(!1),o=Object(b.a)(r,2),a=(o[0],o[1]),l=Object(n.useState)(null),i=Object(b.a)(l,2),j=i[0],u=i[1],d=Object(n.useState)(null),h=Object(b.a)(d,2),v=h[0],N=h[1],y=Object(n.useState)(null),w=Object(b.a)(y,2),k=w[0],S=w[1];return Object(n.useEffect)((function(){if(j){var e=new O.a(j,{host:"present.mathematikoi.xyz",port:80,path:"/server/peerjs"});return e.on("call",(function(e){console.log("we called"),e.answer(),e.on("stream",(function(e){console.log("we got a stream",e),S(e)}))})),e.on("error",(function(e){console.log("peer error",e)})),e.on("disconnected",(function(){console.log("peer disconnected")})),function(){e.destroy()}}}),[j]),Object(f.jsxs)("div",{className:"w-full h-full relative flex items-center justify-center gap-4",children:[!v&&Object(f.jsx)(g,{error:c,onSubmit:function(e){u(e.name);var t=Object(x.a)("http://present.mathematikoi.xyz",{path:"/server/socketio",auth:e,reconnection:!1});t.on("connect",(function(){console.log("connected"),a(!0),t.on(t.id,(function(e){console.log(e),N(e)}))})),t.on("connect_error",(function(e){console.log(e),s(e.message)}))}}),v&&!k&&Object(f.jsx)(p,{code:v}),k&&Object(f.jsx)(m,{stream:k})]})};var N=function(){var e=Object(u.g)().host,t=Object(n.useState)(""),c=Object(b.a)(t,2),s=c[0],r=c[1],o=Object(n.useState)(null),a=Object(b.a)(o,2),l=a[0],i=a[1],j=Object(n.useState)(!1),d=Object(b.a)(j,2),h=d[0];return d[1],h?Object(f.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:Object(f.jsxs)("div",{className:"flex flex-col p-6 shadow space-y-4 bg-gray-300 rounded",children:[Object(f.jsxs)("p",{className:"text-center",children:[Object(f.jsx)("span",{className:"inline-block bg-green-500 w-2 h-2 rounded-full mr-2"})," ","you are presenting on ",Object(f.jsx)("strong",{children:e}),"!"]}),Object(f.jsx)("button",{className:"bg-gray-500 rounded p-2",children:"stop sharing"})]})}):h?void 0:Object(f.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:Object(f.jsxs)("div",{className:"flex flex-col p-6 shadow space-y-4 bg-gray-300 rounded",children:[Object(f.jsxs)("h1",{className:"text-center",children:["stream to ",Object(f.jsx)("strong",{children:e})]}),Object(f.jsxs)("div",{className:"space-y-2",children:[Object(f.jsx)("label",{className:"block",children:Object(f.jsx)("span",{children:"Code:"})}),Object(f.jsx)("input",{className:"p-2 rounded text-center",autoFocus:!0,value:s,onChange:function(e){return r(e.target.value)}})]}),l&&Object(f.jsx)("p",{className:"py-2 px-4 bg-red-500 rounded",children:l}),Object(f.jsx)("button",{className:"bg-gray-500 rounded p-2",onClick:function(){console.log("sharing screen"),navigator.mediaDevices.getDisplayMedia().then((function(t){console.log(t);var c=new O.a({host:"present.mathematikoi.xyz",port:80,path:"/server/peerjs"});c.on("open",(function(n){console.log("peer open",n),c.call(e,t)})),c.on("connection",(function(e){console.log("peer connection",e)})),c.on("error",(function(e){console.log("peer error",e)})),c.on("close",(function(){console.log("peer close")})),c.on("disconnected",(function(){console.log("peer disconnected")}))})).catch((function(e){i(e.message)}))},children:"share screen"})]})})};function y(e){return Object(f.jsxs)("div",{className:"bg-gray-300 p-4 rounded space-y-4 w-56",children:[Object(f.jsxs)("div",{className:"flex items-center justify-between",children:[Object(f.jsx)("h1",{className:"text-lg font-semibold",children:e.host.name}),Object(f.jsxs)("h1",{className:"flex items-center",children:[Object(f.jsx)("span",{className:"inline-block bg-green-500 w-2 h-2 rounded-full mr-2"}),e.host.state]})]}),Object(f.jsx)(j.b,{className:"w-full inline-block bg-gray-500 rounded p-2 text-center",to:"/present/"+e.host.name,children:"present"})]})}function w(){var e=Object(i.useQuery)("hosts",(function(){return l.a.get("/server/hosts")})),t=e.isLoading,c=e.isError,n=e.isSuccess,s=e.data,r=e.error,o=null===s||void 0===s?void 0:s.data;return Object(f.jsxs)("div",{className:"w-full h-full relative flex items-center justify-center gap-4",children:[t&&Object(f.jsx)("h1",{children:"loading..."}),c&&Object(f.jsxs)("h1",{children:["error fetching hosts ",r.toString(),"..."]}),n&&!(null===o||void 0===o?void 0:o.length)&&Object(f.jsx)("h1",{children:"there are no registered hosts."}),n&&(null===o||void 0===o?void 0:o.map((function(e,t){return Object(f.jsx)(y,{host:e},t)}))),Object(f.jsx)("div",{className:"absolute bottom-4 right-4",children:Object(f.jsx)(j.b,{to:"/host",className:"bg-gray-500 rounded p-2",children:"add a host"})})]})}var k=new i.QueryClient;var S=function(){return Object(f.jsx)("div",{className:"w-full h-full bg-gray-200",children:Object(f.jsx)(i.QueryClientProvider,{client:k,children:Object(f.jsx)(j.a,{children:Object(f.jsxs)(u.c,{children:[Object(f.jsx)(u.a,{path:"/",exact:!0,element:Object(f.jsx)(w,{})}),Object(f.jsx)(u.a,{path:"/host",element:Object(f.jsx)(v,{})}),Object(f.jsx)(u.a,{path:"/present/:host",element:Object(f.jsx)(N,{})})]})})})})};o.a.render(Object(f.jsx)(s.a.StrictMode,{children:Object(f.jsx)(S,{})}),document.getElementById("root"))},79:function(e,t,c){},98:function(e,t){function c(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}c.keys=function(){return[]},c.resolve=c,e.exports=c,c.id=98}},[[105,1,2]]]);
//# sourceMappingURL=main.ce935df1.chunk.js.map