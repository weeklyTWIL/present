{"version":3,"sources":["Host/index.js","Present/index.js","Application.js","index.js","../node_modules/peerjs/dist sync"],"names":["Streamor","props","useEffect","video","document","getElementById","console","log","stream","srcObject","className","id","autoPlay","Authenticator","code","HostRegistror","useState","name","secret","credentials","set_credentials","autoFocus","value","onChange","e","target","error","onClick","onSubmit","Host","set_error","set_connected","host","set_host","set_code","set_stream","peer","Peer","port","path","on","call","answer","_stream","err","destroy","socket","io","auth","reconnection","message","Present","useParams","is_streaming","navigator","mediaDevices","getDisplayMedia","then","conn","catch","HostThumbnail","state","to","HostsList","useQuery","axios","get","isLoading","isError","isSuccess","data","hosts","toString","length","map","i","queryClient","QueryClient","Application","client","exact","element","ReactDOM","render","StrictMode","webpackEmptyContext","req","Error","keys","resolve","module","exports"],"mappings":"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","file":"static/js/main.ce935df1.chunk.js","sourcesContent":["import Peer from \"peerjs\";\nimport { useEffect, useMemo, useRef, useState } from \"react\";\nimport { Link, useParams } from \"react-router-dom\";\nimport { io } from \"socket.io-client\";\n\nfunction Streamor(props) {\n  useEffect(() => {\n    const video = document.getElementById(\"stream\");\n    console.log(video, props.stream);\n    video.srcObject = props.stream;\n  }, []);\n\n  return (\n    <div className=\"h-full w-full\">\n      <video id=\"stream\" autoPlay className=\"w-full h-full\"></video>\n    </div>\n  );\n}\n\nfunction Authenticator(props) {\n  return (\n    <div className=\"h-full w-full flex items-center justify-center\">\n      <h1 className=\"text-7xl\">{props.code}</h1>\n    </div>\n  );\n}\n\nfunction HostRegistror(props) {\n  const [credentials, set_credentials] = useState({\n    name: \"\",\n    secret: \"\",\n  });\n\n  return (\n    <div className=\"flex flex-col p-6 shadow space-y-4 bg-gray-300 rounded\">\n      <h1 className=\"text-center\">register a new host</h1>\n      <div className=\"space-y-2\">\n        <label className=\"block\">\n          <span>name:</span>\n        </label>\n        <input\n          className=\"p-2 rounded \"\n          autoFocus\n          value={credentials.name}\n          onChange={(e) =>\n            set_credentials({ ...credentials, name: e.target.value })\n          }\n        />\n      </div>\n\n      <div className=\"space-y-2\">\n        <label className=\"block\">\n          <span>secret:</span>\n        </label>\n        <input\n          className=\"p-2 rounded \"\n          autoFocus\n          value={credentials.secret}\n          onChange={(e) =>\n            set_credentials({ ...credentials, secret: e.target.value })\n          }\n        />\n      </div>\n      {props.error && (\n        <p className=\"py-2 px-4 bg-red-500 rounded\">{props.error}</p>\n      )}\n      <button\n        className=\"bg-gray-500 rounded p-2\"\n        onClick={() => props.onSubmit(credentials)}\n      >\n        register\n      </button>\n    </div>\n  );\n}\n\nfunction Host() {\n  const [error, set_error] = useState(null);\n  const [connected, set_connected] = useState(false);\n  const [host, set_host] = useState(null);\n  const [code, set_code] = useState(null);\n  const [stream, set_stream] = useState(null);\n\n  useEffect(() => {\n    if (host) {\n      const peer = new Peer(host, {\n        host: \"present.mathematikoi.xyz\",\n        port: 80,\n        path: \"/server/peerjs\",\n      });\n\n      peer.on(\"call\", (call) => {\n        console.log(\"we called\");\n        call.answer();\n        call.on(\"stream\", function (_stream) {\n          console.log(\"we got a stream\", _stream);\n          set_stream(_stream);\n        });\n      });\n\n      peer.on(\"error\", (err) => {\n        console.log(\"peer error\", err);\n      });\n\n      peer.on(\"disconnected\", () => {\n        console.log(\"peer disconnected\");\n      });\n      return () => {\n        peer.destroy();\n      };\n    }\n  }, [host]);\n\n  const register_host = (credentials) => {\n    set_host(credentials.name);\n    const socket = io(\"http://present.mathematikoi.xyz\", {\n      path: \"/server/socketio\",\n      auth: credentials,\n      reconnection: false,\n    });\n\n    socket.on(\"connect\", () => {\n      console.log(\"connected\");\n      set_connected(true);\n      socket.on(socket.id, (code) => {\n        console.log(code);\n        set_code(code);\n      });\n    });\n\n    socket.on(\"connect_error\", (error) => {\n      console.log(error);\n      set_error(error.message);\n    });\n  };\n\n  return (\n    <div className=\"w-full h-full relative flex items-center justify-center gap-4\">\n      {!code && <HostRegistror error={error} onSubmit={register_host} />}\n      {code && !stream && <Authenticator code={code} />}\n      {stream && <Streamor stream={stream} />}\n    </div>\n  );\n}\n\nexport default Host;\n","import Peer from \"peerjs\";\nimport { useEffect, useState } from \"react\";\nimport { useParams } from \"react-router-dom\";\nimport { io } from \"socket.io-client\";\n\nfunction Present() {\n  const { host } = useParams();\n  const [code, set_code] = useState(\"\");\n  const [error, set_error] = useState(null);\n  const [is_streaming, set_is_streaming] = useState(false);\n\n  const share_screen = () => {\n    console.log(\"sharing screen\")\n      navigator.mediaDevices\n        .getDisplayMedia()\n        .then((stream) => {\n          console.log(stream)\n          const peer = new Peer({\n            host: \"present.mathematikoi.xyz\",\n            port: 80,\n            path: \"/server/peerjs\",\n          });\n\n          peer.on(\"open\", (id) => {\n            console.log(\"peer open\", id);\n            peer.call(host, stream);\n          });\n\n          peer.on(\"connection\", (conn) => {\n            console.log(\"peer connection\", conn);\n          });\n\n          peer.on(\"error\", (err) => {\n            console.log(\"peer error\", err);\n          });\n\n          peer.on(\"close\", () => {\n            console.log(\"peer close\");\n          });\n\n          peer.on(\"disconnected\", () => {\n            console.log(\"peer disconnected\");\n          });\n        })\n        .catch((error) => {\n          set_error(error.message);\n        });\n  };\n\n  if (is_streaming) {\n    return (\n      <div className=\"w-full h-full flex items-center justify-center\">\n        <div className=\"flex flex-col p-6 shadow space-y-4 bg-gray-300 rounded\">\n          <p className=\"text-center\">\n            <span className=\"inline-block bg-green-500 w-2 h-2 rounded-full mr-2\"></span>{\" \"}\n            you are presenting on <strong>{host}</strong>!\n          </p>\n          <button\n            className=\"bg-gray-500 rounded p-2\"\n          >\n            stop sharing\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  if (!is_streaming)\n    return (\n      <div className=\"w-full h-full flex items-center justify-center\">\n        <div className=\"flex flex-col p-6 shadow space-y-4 bg-gray-300 rounded\">\n          <h1 className=\"text-center\">\n            stream to <strong>{host}</strong>\n          </h1>\n          <div className=\"space-y-2\">\n            <label className=\"block\">\n              <span>Code:</span>\n            </label>\n            <input\n              className=\"p-2 rounded text-center\"\n              autoFocus\n              value={code}\n              onChange={(e) => set_code(e.target.value)}\n            />\n          </div>\n          {error && <p className=\"py-2 px-4 bg-red-500 rounded\">{error}</p>}\n          <button className=\"bg-gray-500 rounded p-2\" onClick={share_screen}>\n            share screen\n          </button>\n        </div>\n      </div>\n    );\n}\n\nexport default Present;\n","import axios from \"axios\";\nimport { useEffect, useState } from \"react\";\nimport { QueryClient, QueryClientProvider, useQuery } from \"react-query\";\nimport { BrowserRouter, Route, Routes, Link } from \"react-router-dom\";\nimport Host from \"./Host\";\nimport Present from \"./Present\";\n\nfunction HostThumbnail(props) {\n  return (\n    <div className=\"bg-gray-300 p-4 rounded space-y-4 w-56\">\n      <div className=\"flex items-center justify-between\">\n        <h1 className=\"text-lg font-semibold\">{props.host.name}</h1>\n        <h1 className=\"flex items-center\">\n          <span className=\"inline-block bg-green-500 w-2 h-2 rounded-full mr-2\"></span>\n          {props.host.state}\n        </h1>\n      </div>\n      <Link\n        className=\"w-full inline-block bg-gray-500 rounded p-2 text-center\"\n        to={\"/present/\" + props.host.name}\n      >\n        present\n      </Link>\n    </div>\n  );\n}\n\nfunction HostsList() {\n  const { isLoading, isError, isSuccess, data, error } = useQuery(\"hosts\", () =>\n    axios.get(\"/server/hosts\")\n  );\n\n  const hosts = data?.data\n\n  return (\n    <div className=\"w-full h-full relative flex items-center justify-center gap-4\">\n      {isLoading && <h1>loading...</h1>}\n      {isError && <h1>error fetching hosts {error.toString()}...</h1>}\n      {isSuccess && !hosts?.length && <h1>there are no registered hosts.</h1>}\n      {isSuccess && hosts?.map((host, i) => <HostThumbnail host={host} key={i} />)}\n      <div className=\"absolute bottom-4 right-4\">\n        <Link to=\"/host\" className=\"bg-gray-500 rounded p-2\">\n          add a host\n        </Link>\n      </div>\n    </div>\n  );\n}\n\nconst queryClient = new QueryClient();\n\nfunction Application() {\n  return (\n    <div className=\"w-full h-full bg-gray-200\">\n      <QueryClientProvider client={queryClient}>\n        <BrowserRouter>\n          <Routes>\n            <Route path=\"/\" exact element={<HostsList />}></Route>\n            <Route path=\"/host\" element={<Host />}></Route>\n            <Route path=\"/present/:host\" element={<Present />}></Route>\n          </Routes>\n        </BrowserRouter>\n      </QueryClientProvider>\n    </div>\n  );\n}\n\nexport default Application;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport Application from './Application';\n\nReactDOM.render(\n  <React.StrictMode>\n    <Application />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n","function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = 98;"],"sourceRoot":""}